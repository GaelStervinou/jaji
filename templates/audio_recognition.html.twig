<!DOCTYPE html>
<html>
<head>
    <title>Audio to Text</title>
</head>
<body>
    <h1>Transcription Audio en Texte</h1>
    <form id="audioForm" method="post" enctype="multipart/form-data" action="/audio-recognition/send-audio">
      <input type="file" id="audioFile" name="audioFile" accept="audio/*">
      <button type="submit">Transcrire</button>
    </form>
    <p id="transcription"></p>

    <script>
      document.getElementById('audioForm').addEventListener('submit', function(event) {
        event.preventDefault();
        
        const formData = new FormData(this);
        fetch(this.action, {
            method: 'POST',
            body: formData
        })
        .then(response => response.text())
        .then(data => {
            document.getElementById("transcription").innerText = data;
        })
        .catch(error => {
            console.error('Erreur lors de la transcription:', error);
            alert('Une erreur est survenue lors de la transcription.');
        });
      });


        {# document.getElementById('transcribeButton').addEventListener('click', function() {
            const audioFile = document.getElementById('audioFile').files[0];
            if (!audioFile) {
                alert("Veuillez charger un fichier audio.");
                return;
            }

            // Créer un objet FormData pour envoyer le fichier
            const formData = new FormData();
            formData.append('audioFile', audioFile);

            // Envoyer la requête POST vers ton endpoint Symfony
            fetch('/audio-recognition/send-audio', {
                method: 'POST',
                body: formData
            })
            .then(response => response.text())
            .then(data => {
                document.getElementById('transcription').innerText = data;
            })
            .catch(error => {
                console.error('Erreur lors de la transcription:', error);
                alert('Une erreur est survenue lors de la transcription.');
            });
        }); #}
    </script>
</body>
</html>

{# const http = new XMLHttpRequest();
const url = "https://api.openai.com/v1/audio/transcriptions";
const token = "sk-proj-6rEP6r3SlVCbp5SjW1M3T3BlbkFJich5OaVwcksildhdcAbD";

http.open("POST", url, true);
http.setRequestHeader("Authorization", `Bearer ${token}`);

const formData = new FormData();
formData.append('file', audioFile);
formData.append('model', 'whisper-1');
formData.append('response_format', 'text');

http.onreadystatechange = function() {
    if (this.readyState === 4 && this.status === 200) {
        document.getElementById("transcription").innerHTML = this.responseText;
    }
};

http.send(formData); #}